"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[592],{6581:(d,c,r)=>{r.d(c,{l:()=>u});var p=r(2340),f=r(1135),i=r(2843),s=r(9646),a=r(3900),o=r(262),h=r(4650),l=r(529);let u=(()=>{class n{constructor(t){this._httpClient=t,this.apiHost=p.N.apiHost,this._authenticated=!1,this._playerInfo=new f.X(null)}set accessToken(t){sessionStorage.removeItem("access_token"),sessionStorage.setItem("access_token",t)}get accessToken(){return sessionStorage.getItem("access_token")??""}get playerInfo$(){return this._playerInfo.asObservable()}set playerInfo(t){this._playerInfo.next(t)}playerSignIn(t){return this._authenticated?(0,i._)("User is already logged in."):this._httpClient.post(`${this.apiHost}fsr/player/login/`,t).pipe((0,a.w)(e=>(this.accessToken=e.token,this._authenticated=!0,(0,s.of)(e))))}playerSessionSignIn(t){return this._authenticated?(0,i._)("User is already logged in."):this._httpClient.post(`${this.apiHost}fsr/session/login/`,t).pipe((0,a.w)(e=>(this.accessToken=e.token,this._authenticated=!0,(0,s.of)(e))))}getSessionDetails(){return this._httpClient.get(`${this.apiHost}fsr/session/`).pipe((0,a.w)(t=>(0,s.of)(t)))}verifyPlayerLanding(t){return this._httpClient.post(`${this.apiHost}fsr/player/setup`,t).pipe((0,o.K)(e=>(0,i._)(e)),(0,a.w)(e=>(this.accessToken=e.token,this._authenticated=!0,(0,s.of)(e))))}verifyReportSubmission(t){return this._httpClient.post(`${this.apiHost}fsr/session/handshake`,t).pipe((0,o.K)(e=>(0,i._)(e)),(0,a.w)(e=>(this.accessToken=e.token,(0,s.of)(e))))}updatePlayer(t){return this._httpClient.put(`${this.apiHost}fsr/player`,t).pipe((0,o.K)(e=>(0,i._)(e)),(0,a.w)(e=>(0,s.of)(e)))}validateToken(){return this._httpClient.post(`${this.apiHost}fsr/player/validate-token`,{}).pipe((0,o.K)(()=>(0,s.of)(!1)),(0,a.w)(t=>(this._authenticated=t?.valid,(0,s.of)(t?.valid))))}check(){let t=(0,s.of)(!1);return this._authenticated&&(t=(0,s.of)(!0)),t=this.accessToken?this.validateToken():(0,s.of)(!1),t}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(l.eN))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},5861:(d,c,r)=>{function p(i,s,a,o,h,l,u){try{var n=i[l](u),_=n.value}catch(t){return void a(t)}n.done?s(_):Promise.resolve(_).then(o,h)}function f(i){return function(){var s=this,a=arguments;return new Promise(function(o,h){var l=i.apply(s,a);function u(_){p(l,o,h,u,n,"next",_)}function n(_){p(l,o,h,u,n,"throw",_)}u(void 0)})}}r.d(c,{Z:()=>f})}}]);