"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[596],{5596:(q,u,n)=>{n.r(u),n.d(u,{AppPatchModule:()=>k});var d=n(6895),f=n(2510),g=n(529),i=n(4006),P=n(8746),t=n(4650),Z=n(2340),N=n(262),w=n(2843),T=n(3900),y=n(9646);let C=(()=>{class e{constructor(o){this._httpClient=o,this.apiHost=Z.N.apiHost}set accessToken(o){sessionStorage.removeItem("access_token"),sessionStorage.setItem("access_token",o)}get accessToken(){return sessionStorage.getItem("access_token")??""}Upload(o){return this._httpClient.post(`${this.apiHost}patch/add`,o,{reportProgress:!0,observe:"events"}).pipe((0,N.K)(r=>(0,w._)(r)),(0,T.w)(r=>(0,y.of)(r)))}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(g.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var h=n(4859),v=n(7392),x=n(3162),l=n(9549),A=n(4144),p=n(1948);function I(e,s){1&e&&(t.TgZ(0,"span",29),t._uU(1,"We are now saving your files to our server."),t.qZA())}function b(e,s){if(1&e&&t._UZ(0,"mat-progress-bar",30),2&e){const o=t.oxw(2);t.Q6J("value",o.uploadProgress)("mode","determinate")}}function S(e,s){1&e&&t._UZ(0,"mat-progress-bar",31),2&e&&t.Q6J("mode","indeterminate")}function F(e,s){if(1&e&&(t.ynx(0),t.TgZ(1,"span",23),t._uU(2,"Please wait while we submit your patch."),t.qZA(),t.TgZ(3,"span",24)(4,"span",25),t._uU(5,"DO NOT"),t.qZA(),t._uU(6," refresh or close this browser, or even switch to other app until we finish everything."),t.qZA(),t.YNc(7,I,2,0,"span",26),t.YNc(8,b,1,2,"mat-progress-bar",27),t.YNc(9,S,1,1,"mat-progress-bar",28),t.BQk()),2&e){const o=t.oxw();t.xp6(7),t.Q6J("ngIf",o.savinginProgress),t.xp6(1),t.Q6J("ngIf",!o.savinginProgress),t.xp6(1),t.Q6J("ngIf",o.savinginProgress)}}function J(e,s){1&e&&(t.TgZ(0,"span",36),t._uU(1,"Submit"),t.qZA())}function U(e,s){if(1&e){const o=t.EpF();t.TgZ(0,"div",32)(1,"button",33),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.submit())}),t.TgZ(2,"div"),t.YNc(3,J,2,0,"span",34),t.TgZ(4,"span",35),t._uU(5,"Submit"),t.qZA()()()()}if(2&e){const o=t.oxw();t.xp6(1),t.Q6J("color","primary")("disabled",!o.patchFormGroup.get("versionNo").valid),t.xp6(2),t.Q6J("ngIf",o.patchFormGroup.get("versionNo").valid)}}const Q=[{path:"",data:{layout:"empty"},children:[{path:"add",data:{layout:"centered"},component:(()=>{class e{constructor(o,r){this._formBuilder=o,this._patchService=r,this.uploadProgress=0,this.savinginProgress=!1,this.isSubmitting=!1}ngOnInit(){this.patchFormGroup=this._formBuilder.group({versionNo:[null,i.kI.compose([i.kI.required])],persistDb:["true",i.kI.compose([i.kI.required])]})}onFileSelected(o){this.fileSelected=o.target.files[0],new FileReader,this.totalFileSize=this.fileSelected?.size}submit(){this.isSubmitting=!0;const o=new FormData;o.append("versionNo",this.patchFormGroup.get("versionNo").value),o.append("isPersistDb",this.patchFormGroup.get("persistDb").value),o.append("files",this.fileSelected),this._patchService.Upload(o).pipe((0,P.x)(()=>{this.uploadProgress=0,this.savinginProgress=!1,this.isSubmitting=!1})).subscribe(a=>{if(a.type==g.dt.UploadProgress){const c=Math.round(a.loaded/a.total*100);this.uploadProgress=c,c>=100&&(this.savinginProgress=!0)}},a=>{})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(i.QS),t.Y36(C))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-add-new-patch"]],decls:32,vars:5,consts:[[1,"flex","flex-col","items-center","justify-center","flex-auto","p-4"],[1,"flex","items-center","justify-end","w-full","sm:w-auto","p-2","rounded-2xl","shadow-lg","sm:bg-card","max-w-[1000px]","md:min-w-[580px]"],[1,"w-full","p-2","sm:mx-0"],[1,"flex","flex-col","items-center","justify-center","mt-2","font-medium"],[1,"text-center"],[3,"formGroup"],["appearance","fill",1,"w-full","mt-4"],["required","","matInput","","placeholder","Version number","type","text","inputmode","numeric","formControlName","versionNo","required",""],["mat-icon-button","","type","button","matSuffix","",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"flex","flex-row","justify-center"],["required","","formControlName","persistDb"],["value","false",1,"mr-6"],["value","true",1,"mr-6"],["hidden","","type","file","accept",".zip",3,"change"],["selectFile",""],[1,"mt-4","flex","flex-row","justify-center"],[1,"flex-row","justify-center","icon-size-20","text-gray-200",3,"svgIcon"],[1,"flex","flex-col","justify-center","w-[150px]","h-[30px]","rounded-lg","shadow-lg","cursor-pointer","bg-purple-700","hover:bg-purple-500","hover:shadow-xl",3,"click"],[1,"text-white","text-md","text-center","w-full"],[1,"relative","flex","flex-col","left-0","z-49","mt-2"],[4,"ngIf"],["class","mt-2 flex flex-row items-end justify-end",4,"ngIf"],[1,"text-start","font-medium","text-md","mt-2","break-words","whitespace-pre-line"],[1,"text-start","font-medium","text-md","mt-4","break-words","whitespace-pre-line","text-red-600"],[1,"p-[5px]","text-white","bg-red-500","font-semibold"],["class","mt-2 text-start font-medium text-md break-words whitespace-pre-line text-green-500",4,"ngIf"],["class","mt-2 w-full h-[10px]",3,"value","mode",4,"ngIf"],["class","mt-2 w-full h-[10px]",3,"mode",4,"ngIf"],[1,"mt-2","text-start","font-medium","text-md","break-words","whitespace-pre-line","text-green-500"],[1,"mt-2","w-full","h-[10px]",3,"value","mode"],[1,"mt-2","w-full","h-[10px]",3,"mode"],[1,"mt-2","flex","flex-row","items-end","justify-end"],["mat-flat-button","",3,"color","disabled","click"],["class","absolute inline-flex animate-ping text-white",4,"ngIf"],[1,"relative","inline-flex","text-white"],[1,"absolute","inline-flex","animate-ping","text-white"]],template:function(o,r){if(1&o){const a=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t._uU(5,"Please fill the following information."),t.qZA()(),t.TgZ(6,"form",5)(7,"mat-form-field",6)(8,"mat-label"),t._uU(9,"Version"),t.qZA(),t._UZ(10,"input",7),t.TgZ(11,"button",8),t.NdJ("click",function(){return r.patchFormGroup.get("versionNo").setValue("")}),t._UZ(12,"mat-icon",9),t.qZA(),t.TgZ(13,"mat-error"),t._uU(14," Version is required. "),t.qZA()(),t.TgZ(15,"div",10)(16,"mat-radio-group",11)(17,"mat-radio-button",12),t._uU(18,"Delete Database"),t.qZA(),t.TgZ(19,"mat-radio-button",13),t._uU(20,"Persist Database"),t.qZA()()(),t.TgZ(21,"input",14,15),t.NdJ("change",function(m){return r.onFileSelected(m)}),t.qZA(),t.TgZ(23,"div",16),t._UZ(24,"mat-icon",17),t.qZA(),t.TgZ(25,"div",16)(26,"button",18),t.NdJ("click",function(){t.CHM(a);const m=t.MAs(22);return t.KtG(m.click())}),t.TgZ(27,"span",19),t._uU(28,"Select patch (.zip)"),t.qZA()()(),t.TgZ(29,"div",20),t.YNc(30,F,10,3,"ng-container",21),t.qZA(),t.YNc(31,U,6,3,"div",22),t.qZA()()()()}2&o&&(t.xp6(6),t.Q6J("formGroup",r.patchFormGroup),t.xp6(6),t.Q6J("svgIcon","heroicons_solid:x-circle"),t.xp6(12),t.Q6J("svgIcon","heroicons_solid:cube"),t.xp6(6),t.Q6J("ngIf",r.isSubmitting),t.xp6(1),t.Q6J("ngIf",!r.isSubmitting))},dependencies:[d.O5,h.lW,v.Hw,x.pW,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,l.TO,l.KE,l.hX,l.R9,A.Nt,p.VQ,p.U0]}),e})()}]}];let z=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[f.Bz.forChild(Q),f.Bz]}),e})();var j=n(8277),G=n(7957),M=n(811),D=n(7331),Y=n(9602),B=n(5412),H=n(4850),V=n(782),E=n(8255),O=n(1572),R=n(4385),K=n(455),L=n(7009),W=n(6257),X=n(7775),$=n(4466);let k=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.ez,z,d.ez,h.ot,M.vV,H.t,v.Ps,E.Tx,x.Cv,$.m,l.lN,B.Is,A.c,K.rP,D.Hi,G.Bb,O.Cq,L.ZX,X.fC,W.T5,Y.FA,j.Yd,R.LD,p.Fk,V.N6]}),e})()}}]);